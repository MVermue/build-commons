<?xml version="1.0" encoding="UTF-8"?>
<project name="ant-build-commons-pear-test" basedir="." default="test-run">

    <!--
        Define a resource directory
    -->
    <property name="resourcedir" location="../../../main/resources" />

    <!--
        Define test build dir.
    -->
    <property name="testdir" location="/tmp/abc-test/run" />

    <!--
        Define test build file.
    -->
    <property name="antfile" location="../../../main/xml/exts/pear.xml" />

    <target name="test-run"
            depends="-setUp, test-pear-initialize, -tearDown" />

    <target name="-setUp" depends="-tearDown">
        <mkdir dir="${testdir}" />
    </target>

    <target name="-tearDown">
        <delete includeemptydirs="true" dir="${testdir}" />
    </target>

    <target name="test-pear-initialize">
        <ant antfile="${antfile}" target="pear:initialize">
            <property name="basedir" value="${testdir}" />
        </ant>

        <fail message="Cannot locate expected pear base structure.">
            <condition>
                <not>
                    <available file="${testdir}/../.pear" />
                </not>
            </condition>
        </fail>
    </target>

</project>